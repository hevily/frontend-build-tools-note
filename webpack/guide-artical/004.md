## 输出管理

前面的案例中，我们手动地把相关静态文件引入到index.html中，虽然这看上去简单极了，但是其实这是有问题的！比如说，将来的你给打包后的文件使用hash命名，或者说你打包了多个入口文件，那么此时你就不可能去手动的引入相关文件了，因为每次打包文件名字都是变了的，也就是每打包一次，你就需要去手动引用一次。其实我们我几个相关的插件可以实现自动帮我们引入相关文件到我们指定的html文件中。

### 准备

首先，我们先做一个小小的改动，之后项目目录如下：
* project

```json
  webpack-demo
  |- package.json
  |- webpack.config.js
  |- /dist
  |- /src
    |- index.js
+   |- print.js
  |- /node_modules
```
并且，我们向print.js里面加入下面的内容：

* src/print.js
```javascript
export default function printMe() {
  console.log('I get called from print.js!');
}
```
随后我们再index.js中引入print.js中暴露的方法。

* src/index.js
```javascript
  import _ from 'lodash';
+ import printMe from './print.js';

  function component() {
    var element = document.createElement('div');
+   var btn = document.createElement('button');

    element.innerHTML = _.join(['Hello', 'webpack'], ' ');

+   btn.innerHTML = 'Click me and check the console!';
+   btn.onclick = printMe;
+
+   element.appendChild(btn);

    return element;
  }

  document.body.appendChild(component());
```
此时我们改一下index.html，为后面webpack打包分离的两个文件做准备：

* dist/index.html
```html
  <!doctype html>
  <html>
    <head>
-     <title>Asset Management</title>
+     <title>Output Management</title>
+     <script src="./print.bundle.js"></script>
    </head>
    <body>
-     <script src="./bundle.js"></script>
+     <script src="./app.bundle.js"></script>
    </body>
  </html>
```
紧接着，我们改一下webpack配置文件，以便webpack打包多入口文件。

* webpack.config.js
```javascript
  const path = require('path');

  module.exports = {
-   entry: './src/index.js',
+   entry: {
+     app: './src/index.js',
+     print: './src/print.js'
+   },
    output: {
-     filename: 'bundle.js',
+     filename: '[name].bundle.js',
      path: path.resolve(__dirname, 'dist')
    }
  };
```

此时运行打包命令，

```bash
npm run build
```

输出如下：

```bash
Hash: aa305b0f3373c63c9051
Version: webpack 3.0.0
Time: 536ms
          Asset     Size  Chunks                    Chunk Names
  app.bundle.js   545 kB    0, 1  [emitted]  [big]  app
print.bundle.js  2.74 kB       1  [emitted]         print
   [0] ./src/print.js 84 bytes {0} {1} [built]
   [1] ./src/index.js 403 bytes {0} [built]
   [3] (webpack)/buildin/global.js 509 bytes {0} [built]
   [4] (webpack)/buildin/module.js 517 bytes {0} [built]
    + 1 hidden module
```
此时我们如果打开index.html文件，一切都会按照我们事先的确定好的意愿运行！

但是如果我们此时，重命名了入口文件，或者加入一个新的入口文件，那么就有问题了，因为当我们再次打包的时候，打包文件的名字已经变了，而我们index.html引入的文件名字还是之前的名字！对此，我们可以是用HtmlWebpackPlugin插件来解决这个问题！

### 设置HtmlWebpackPlugin

首先我们需要安装该插件以及修改webpack配置文件。

```bash
npm install --save-dev html-webpack-plugin
```

* webpack.config.js
```bash
  const path = require('path');
+ const HtmlWebpackPlugin = require('html-webpack-plugin');

  module.exports = {
    entry: {
      app: './src/index.js',
      print: './src/print.js'
    },
+   plugins: [
+     new HtmlWebpackPlugin({
+       title: 'Output Management'
+     })
+   ],
    output: {
      filename: '[name].bundle.js',
      path: path.resolve(__dirname, 'dist')
    }
  };
```
在继续进行下一步之前，我们需要知道，HtmlWebpackPlugin插件会自动生成一个index.html文件，虽然我们的dist目录里面已经有一个index.html文件了，所以最后的结果就是该插件生成的html文件会替换我们之前的文件，我们运行命令查看结果。

```bash
npm run build
```

结果

```bash
Hash: 81f82697c19b5f49aebd
Version: webpack 2.6.1
Time: 854ms
           Asset       Size  Chunks                    Chunk Names
 print.bundle.js     544 kB       0  [emitted]  [big]  print
   app.bundle.js    2.81 kB       1  [emitted]         app
      index.html  249 bytes          [emitted]
   [0] ./~/lodash/lodash.js 540 kB {0} [built]
   [1] (webpack)/buildin/global.js 509 bytes {0} [built]
   [2] (webpack)/buildin/module.js 517 bytes {0} [built]
   [3] ./src/index.js 172 bytes {1} [built]
   [4] multi lodash 28 bytes {0} [built]
Child html-webpack-plugin for "index.html":
       [0] ./~/lodash/lodash.js 540 kB {0} [built]
       [1] ./~/html-webpack-plugin/lib/loader.js!./~/html-webpack-plugin/default_index.ejs 538 bytes {0} [built]
       [2] (webpack)/buildin/global.js 509 bytes {0} [built]
       [3] (webpack)/buildin/module.js 517 bytes {0} [built]
```
其实HtmlWebpackPlugin插件做的事情就是，自动生成一个index.html文件，然后自动把我们打包文件引入到里面。其它更高级的功能，可以查看[HtmlWebpackPlugin](https://github.com/jantimon/html-webpack-plugin)文档！
